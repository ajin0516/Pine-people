<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <div th:replace="base :: base-head"></div>
    <!--        <link   rel="stylesheet"  th:href="@{/assets/css/stars.css}"/>-->
    <link   rel="stylesheet"  href="/static/assets/css/stars.css"/>
</head>

<body>
<!-- Navigation-->
<div th:insert="~{base :: pinepeople-nav}"></div>

<!-- Header-->
<header class="bg-yellow py-5">
    <div class="container px-4 px-lg-5 my-5">
        <div class="text-center text-white">
            <h1 class="display-4 fw-bolder">Pine People</h1>
            <p class="lead fw-normal text-white-50 mb-0">프로필페이지</p>
        </div>
    </div>
</header>

<!-- Section-->
<section class="py-5">
    <div class="container px-4 px-lg-5 mt-5">
        <div class="row gx-4 gx-lg-5 row-cols-2  justify-content-center">

            <!-- profile start -->
            <div class="col h-100">
                프로필
                <div class="card h-100 p-3">

                    <!-- profile-header -->
                    <div class="h-40 p-2">
                        <div class="row">
                            <div class="col-3 p-1 h-100">
                                <img class="border p-1 rounded h-100 w-100" th:src="${userInfo.profileImg}" alt="profileImg" />
                            </div>
                            <div class="col-9 brix-bar p-1">
                                <div th:text="${userInfo.userName}"></div>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-striped bg-warning" role="progressbar"  th:style="'width:'+${userInfo.brixFiguer}+'%'" th:aria-valuenow="${userInfo.brixFiguer}" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-5 d-grid gap-3">
                        <button type="button" class="btn btn-warning"  data-bs-toggle="modal" data-bs-target="#exampleModal1">당도 평가하기</button>
                        <button class="btn btn-danger" type="button" data-bs-toggle="modal" data-bs-target="#exampleModal2">신고하기</button>
                    </div>

                    <!-- 당도평가하기 -->
                    <div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel1">당도 평가하기</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <h3>파티는 어떠셨나요?</h3>
                                    <div th:text="${userInfo.userName}+'님의 당도를 평가해주세요!'"></div>
                                    <form name="myform" id="myform" method="post" action="./save">
                                        <fieldset class="starSet">
                                            <input type="radio" name="rating" value="5" id="rate1"><label for="rate1">⭐</label>
                                            <input type="radio" name="rating" value="4" id="rate2"><label for="rate2">⭐</label>
                                            <input type="radio" name="rating" value="3" id="rate3"><label for="rate3">⭐</label>
                                            <input type="radio" name="rating" value="2" id="rate4"><label for="rate4">⭐</label>
                                            <input type="radio" name="rating" value="1" id="rate5"><label for="rate5">⭐</label>
                                        </fieldset>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                                    <button type="button" class="btn btn-primary brixButton">확인</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 신고하기 -->
                    <div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel2">신고하기</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <h3 th:text="${userInfo.userName}+'님을 신고하시겠습니까?'"></h3>
                                    <div class="mb-3">
                                        <label for="reportContent" class="form-label">신고 사유를 작성해주세요</label>
                                        <textarea class="form-control" id="reportContent" rows="5"></textarea>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                                    <button type="button" class="btn btn-primary reportButton">신고</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- profile end -->

            <!-- party list start -->
            <!-- 회원 후기 -->
            <!--                    <div class="col h-100">-->
            <!--                        <div th:text="${userInfo.userName}+'님의 후기'"></div>-->
            <!--                        <div class="card h-100">-->
            <!--                            <table class="table">-->
            <!--                                <thead class="table-dark">-->
            <!--                                    <tr>-->
            <!--                                        <th>번호</th>-->
            <!--                                        <th>닉네임</th>-->
            <!--                                        <th>내용</th>-->
            <!--                                    </tr>-->
            <!--                                </thead>-->
            <!--                                <tbody>-->
            <!--                                    <tr>-->
            <!--                                        <th>1</th>-->
            <!--                                        <th>수진뽕뽕걸</th>-->
            <!--                                        <th>너무 친절해요~~~~</th>-->
            <!--                                    </tr>-->
            <!--                                    <tr>-->
            <!--                                        <th>2</th>-->
            <!--                                        <th>아진아아진</th>-->
            <!--                                        <th>너무 친절하고 카인드함돠</th>-->
            <!--                                    </tr>-->
            <!--                                    <tr>-->
            <!--                                        <th>3</th>-->
            <!--                                        <th>정정정희</th>-->
            <!--                                        <th>베리굳굳ㄱ둑덜</th>-->
            <!--                                    </tr>-->
            <!--                                </tbody>-->
            <!--                            </table>-->

            <!--                            <div class="text-center">-->
            <!--                                <nav  aria-label="...">-->
            <!--                                    <ul class="pagination pagination-sm" style="justify-content : center">-->
            <!--                                      <li class="page-item active" aria-current="page">-->
            <!--                                        <span class="page-link">1</span>-->
            <!--                                      </li>-->
            <!--                                      <li class="page-item"><a class="page-link" href="#">2</a></li>-->
            <!--                                      <li class="page-item"><a class="page-link" href="#">3</a></li>-->
            <!--                                    </ul>-->
            <!--                                </nav>-->
            <!--                            </div>-->

            <!--                        </div>-->
            <!--                        <div class="mt-2 d-grid gap-3">-->
            <!--                            <button type="button" class="btn btn-dark">후기 작성하기</button>-->
            <!--                        </div>-->
            <!--                    </div>-->
            <!-- party list end -->
        </div>
    </div>
</section>

<!-- Footer-->
<div th:insert="~{base :: pinepeople-footer}"></div>

<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
    $('.brixButton').on("click", function(){
        /*<![CDATA[*/
        var userId = [[${userInfo.userId}]];
        /*]]>*/

        let url = `/pinepeople/api/users/`+userId+`/brix`;
        var sendData = JSON.stringify({
            star: $("input[type=radio][name=rating]:checked").val()
        })

        $.ajax({
            url: url,
            data: sendData,
            contentType: 'application/json',
            type:'POST',
            success:function(data){
                alert("당도 측정 완료!")
            },
            error:function (data){
                alert(data.responseJSON.result.message)
            }
        })
    })

    $('.reportButton').on("click", function(){
        /*<![CDATA[*/
        var userId = [[${userInfo.userId}]];
        /*]]>*/

        let url = `/pinepeople/api/users/`+userId+`/reports`;
        console.log(url)
        let sendData = JSON.stringify({
            reportContent: $('#reportContent').val()
        })
        $.ajax({
            url: url,
            data: sendData,
            contentType: 'application/json',
            type:'POST',
            success:function(data){
                alert("신고 완료!")
            },
            error:function (data){
                alert(data.responseJSON.result.message)
            }
        })
    })

</script>

</body>
</html>